
<!DOCTYPE html>
<html><head><meta charset="UTF-8">
<style>body{font-family:monospace;padding:2rem;background:#f5f5f5;}pre{background:#fff;padding:1rem;border:1px solid #ddd;overflow-x:auto;font-size:.72rem;}</style>
</head>
<body>
<h1>Debug â€” Octubre 2025</h1>
<pre id="out">Cargando...</pre>
<script>
const SHEET_ID = '1BmKygJycO6wTF409i0stnVg3GX26apWGgQ-byPbRlnA';
const BASE = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json&sheet=`;

async function fetchSheet(name) {
  const res = await fetch(BASE + encodeURIComponent(name));
  const txt = await res.text();
  const json = JSON.parse(txt.match(/google\.visualization\.Query\.setResponse\(([\s\S]*)\);?\s*$/)[1]);
  return json.table.rows.map(r => r.c.map(c => c ? c.v : null));
}

async function run() {
  const rows = await fetchSheet('Octubre 2025');
  const lines = [];
  let tIng=0, tEgr=0;

  rows.forEach((row, i) => {
    // show all 8 cols
    lines.push(`Row ${String(i).padStart(2)}: [${row.slice(0,8).map(v=>JSON.stringify(v)).join(', ')}]`);
    if(!row[0]) return;
    if(row[0]==='SALDO MES ANTERIOR'||row[0]==='FECHA'||row[0]==='TOTAL'||String(row[0]).includes('ESTADO DE CUENTA')) return;
    const ing = typeof row[3]==='number' ? row[3] : 0;
    const egr = typeof row[4]==='number' ? row[4] : 0;
    tIng+=ing; tEgr+=egr;
  });

  lines.unshift(`TOTALES: ing=${tIng.toFixed(0)} egr=${tEgr.toFixed(0)}\n`);
  document.getElementById('out').textContent = lines.join('\n');
}
run().catch(e => document.getElementById('out').textContent = 'ERROR: '+e.stack);
</script>
</body>
</html>
