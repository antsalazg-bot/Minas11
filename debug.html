<!DOCTYPE html>
<html><head><meta charset="UTF-8">
<style>body{font-family:monospace;padding:2rem;background:#f5f5f5;}pre{background:#fff;padding:1rem;border:1px solid #ddd;overflow-x:auto;font-size:.72rem;}</style>
</head>
<body>
<h1>Debug v3 â€” typeof cada row[0]</h1>
<pre id="out"></pre>
<script>
const SHEET_ID = '1BmKygJycO6wTF409i0stnVg3GX26apWGgQ-byPbRlnA';
const BASE = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json&sheet=`;
async function fetchSheet(name) {
  const res = await fetch(BASE + encodeURIComponent(name));
  const txt = await res.text();
  return JSON.parse(txt.match(/google\.visualization\.Query\.setResponse\(([\s\S]*)\);?\s*$/)[1]);
}
async function run() {
  const jan = await fetchSheet('Enero 2025');
  const lines = jan.table.rows.map((r, i) => {
    const v0 = r.c[0] ? r.c[0].v : null;
    const v3 = r.c[3] ? r.c[3].v : null;
    const v4 = r.c[4] ? r.c[4].v : null;
    return `Row ${String(i).padStart(2)}: typeof=${typeof v0} | v0=${JSON.stringify(v0)} | ing=${v3} | egr=${v4}`;
  });
  document.getElementById('out').textContent = lines.join('\n');
}
run().catch(e => document.getElementById('out').textContent = 'ERROR: '+e);
</script>
</body>
</html>
